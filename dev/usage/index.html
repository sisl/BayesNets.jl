<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Usage · BayesNets.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="BayesNets.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">BayesNets.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Table of Contents</span><ul><li><a class="tocitem" href="../">BayesNets</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li class="is-active"><a class="tocitem" href>Usage</a><ul class="internal"><li><a class="tocitem" href="#Representation"><span>Representation</span></a></li><li><a class="tocitem" href="#Conditional-Probability-Distributions"><span>Conditional Probability Distributions</span></a></li><li><a class="tocitem" href="#Likelihood"><span>Likelihood</span></a></li><li><a class="tocitem" href="#Sampling"><span>Sampling</span></a></li><li><a class="tocitem" href="#Parameter-Learning"><span>Parameter Learning</span></a></li><li><a class="tocitem" href="#Inference"><span>Inference</span></a></li><li><a class="tocitem" href="#Structure-Learning"><span>Structure Learning</span></a></li><li><a class="tocitem" href="#Reading-from-XDSL"><span>Reading from XDSL</span></a></li><li><a class="tocitem" href="#Bayesian-Score-for-a-Network-Structure"><span>Bayesian Score for a Network Structure</span></a></li></ul></li><li><a class="tocitem" href="../concepts/">Concepts</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Table of Contents</a></li><li class="is-active"><a href>Usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Usage</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sisl/BayesNets.jl/blob/master/docs/src/usage.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h1><pre><code class="language-julia hljs">using Random
Random.seed!(0) # seed the random number generator to 0, for a reproducible demonstration
using BayesNets
using TikzGraphs # required to plot tex-formatted graphs (recommended), otherwise GraphPlot.jl is used
using TikzPictures</code></pre><h2 id="Representation"><a class="docs-heading-anchor" href="#Representation">Representation</a><a id="Representation-1"></a><a class="docs-heading-anchor-permalink" href="#Representation" title="Permalink"></a></h2><p>Bayesian Networks are represented with the <code>BayesNet</code> type. This type contains the directed acyclic graph (a LightTables.DiGraph) and a list of conditional probability distributions (a list of CPDs). Here we construct the BayesNet <span>$a \rightarrow b$</span>, with Gaussians <span>$a$</span> and <span>$b$</span>:</p><p class="math-container">\[a = \mathcal{N}(0,1) \qquad b = \mathcal{N}(2a +3,1)\]</p><pre><code class="language-julia hljs">bn = BayesNet()
push!(bn, StaticCPD(:a, Normal(1.0)))
push!(bn, LinearGaussianCPD(:b, [:a], [2.0], 3.0, 1.0))
plot = BayesNets.plot(bn)
TikzPictures.save(SVG(&quot;plot1&quot;), plot)</code></pre><p><img src="../plot1.svg" alt/></p><h2 id="Conditional-Probability-Distributions"><a class="docs-heading-anchor" href="#Conditional-Probability-Distributions">Conditional Probability Distributions</a><a id="Conditional-Probability-Distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Conditional-Probability-Distributions" title="Permalink"></a></h2><p>Conditional Probability Distributions, <span>$P(x_i \mid \text{parents}(x_i))$</span>, are defined in BayesNets.CPDs. Each CPD knows its own name, the names of its parents, and is associated with a distribution from Distributions.jl.</p><table><tr><th style="text-align: right"><code>CPDForm</code></th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>StaticCPD</code></td><td style="text-align: right">Any <code>Distributions.distribution</code>; independent of any parents</td></tr><tr><td style="text-align: right"><code>FunctionalCPD</code></td><td style="text-align: right">Allows for a CPD defined with a custom eval function</td></tr><tr><td style="text-align: right"><code>ParentFunctionalCPD</code></td><td style="text-align: right">Modification to <code>FunctionalCPD</code> allowing the parent values to be passed in</td></tr><tr><td style="text-align: right"><code>CategoricalCPD</code></td><td style="text-align: right">Categorical distribution, assumes integer parents in <span>$1:N$</span></td></tr><tr><td style="text-align: right"><code>LinearGaussianCPD</code></td><td style="text-align: right">Linear Gaussian, assumes target and parents are numeric</td></tr><tr><td style="text-align: right"><code>ConditionalLinearGaussianCPD</code></td><td style="text-align: right">A linear Gaussian for each discrete parent instantiation</td></tr></table><p>Each CPD can be learned from data using <code>fit</code>. Here we learn the same network as above.</p><pre><code class="language-julia hljs">a = randn(100)
b = randn(100) .+ 2*a .+ 3

data = DataFrame(a=a, b=b)
cpdA = fit(StaticCPD{Normal}, data, :a)
cpdB = fit(LinearGaussianCPD, data, :b, [:a])

bn2 = BayesNet([cpdA, cpdB])</code></pre><p><img src="../plot2.svg" alt/></p><p>Each <code>CPD</code> implements four functions:</p><ul><li><code>name(cpd)</code> - obtain the name of the variable target variable</li><li><code>parents(cpd)</code> - obtain the list of parents</li><li><code>nparams(cpd</code> - obtain the number of free parameters in the CPD</li><li><code>cpd(assignment)</code> - allows calling <code>cpd()</code> to obtain the conditional distribution</li><li><code>Distributions.fit(Type{CPD}, data, target, parents)</code></li></ul><pre><code class="language-julia hljs">cpdB(:a=&gt;0.5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Normal{Float64}(μ=4.060066696064887, σ=2.4296626401406964)</code></pre><p>Several functions conveniently condition and then produce their return values:</p><pre><code class="language-julia hljs">rand(cpdB, :a=&gt;0.5) # condition and then sample
pdf(cpdB, :a=&gt;1.0, :b=&gt;3.0) # condition and then compute pdf(distribution, 3)
logpdf(cpdB, :a=&gt;1.0, :b=&gt;3.0) # condition and then compute logpdf(distribution, 3);</code></pre><p>The NamedCategorical distribution allows for String or Symbol return values. The FunctionalCPD allows for crafting quick and simple CPDs:</p><pre><code class="language-julia hljs">bn2 = BayesNet()
push!(bn2, StaticCPD(:sighted, NamedCategorical([:bird, :plane, :superman], [0.40, 0.55, 0.05])))
push!(bn2, FunctionalCPD{Bernoulli}(:happy, [:sighted], a-&gt;Bernoulli(a == :superman ? 0.95 : 0.2)))</code></pre><p><img src="../plot3.svg" alt/></p><p>Variables can be removed by name using <code>delete!</code>. A warning will be issued when removing a CPD with children.</p><pre><code class="language-julia hljs">delete!(bn2, :happy)</code></pre><p><img src="../plot4.svg" alt/></p><h2 id="Likelihood"><a class="docs-heading-anchor" href="#Likelihood">Likelihood</a><a id="Likelihood-1"></a><a class="docs-heading-anchor-permalink" href="#Likelihood" title="Permalink"></a></h2><p>A Bayesian Network represents a joint probability distribution, <span>$P(x_1, x_2, \ldots, x_n)$</span>. Assignments are represented as dictionaries mapping variable names (Symbols) to variable values. We can evaluate probabilities as we would with Distributions.jl, only we use exclamation points as we modify the internal state when we condition:</p><pre><code class="language-julia hljs">pdf(bn, :a=&gt;0.5, :b=&gt;2.0) # evaluate the probability density</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.01900834726778591</code></pre><p>We can also evaluate the likelihood of a dataset:</p><pre><code class="language-julia hljs">data = DataFrame(a=[0.5,1.0,2.0], b=[4.0,5.0,7.0])
pdf(bn, data)    #  0.00215
logpdf(bn, data) # -6.1386;</code></pre><p>Or the likelihood for a particular cpd:</p><pre><code class="language-julia hljs">pdf(cpdB, data)    #  0.006
logpdf(cpdB, data) # -5.201</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-188.6503322989991</code></pre><h2 id="Sampling"><a class="docs-heading-anchor" href="#Sampling">Sampling</a><a id="Sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling" title="Permalink"></a></h2><p>Assignments can be sampled from a <code>BayesNet</code>.</p><pre><code class="language-julia hljs">rand(bn)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Symbol, Any} with 2 entries:
  :a =&gt; -0.609147
  :b =&gt; 2.27806</code></pre><pre><code class="language-julia hljs">rand(bn, 5)</code></pre><div><div style = "float: left;"><span>5×2 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">a</th><th style = "text-align: left;">b</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1.27749</td><td style = "text-align: right;">7.6911</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">1.98974</td><td style = "text-align: right;">5.76921</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">0.713949</td><td style = "text-align: right;">4.28468</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">2.20322</td><td style = "text-align: right;">8.8321</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">1.28272</td><td style = "text-align: right;">7.10602</td></tr></tbody></table></div><p>In general, sampling can be done according to <code>rand(BayesNet, BayesNetSampler, nsamples)</code> to produce a table of samples, <code>rand(BayesNet, BayesNetSampler)</code> to produce a single Assignment, or <code>rand!(Assignment, BayesNet, BayesNetSampler)</code> to modify an assignment in-place. New samplers need only implement <code>rand!</code>. The functions above default to the <code>DirectSampler</code>, which samples the variables in topographical order.</p><p>Rejection sampling can be used to draw samples that are consistent with a provided assignment:</p><pre><code class="language-julia hljs">bn = BayesNet()
push!(bn, StaticCPD(:a, Categorical([0.3,0.7])))
push!(bn, StaticCPD(:b, Categorical([0.6,0.4])))
push!(bn, CategoricalCPD{Bernoulli}(:c, [:a, :b], [2,2], [Bernoulli(0.1), Bernoulli(0.2), Bernoulli(1.0), Bernoulli(0.4)]))</code></pre><p><img src="../plot5.svg" alt/></p><pre><code class="language-julia hljs">rand(bn, RejectionSampler(:c=&gt;1), 5)</code></pre><p>One can also use weighted sampling:</p><pre><code class="language-julia hljs">rand(bn, LikelihoodWeightedSampler(:c=&gt;1), 5)</code></pre><p>One can also use Gibbs sampling. More options are available than are shown in the example below.</p><pre><code class="language-julia hljs">bn_gibbs = BayesNet()
push!(bn_gibbs, StaticCPD(:a, Categorical([0.999,0.001])))
push!(bn_gibbs, StaticCPD(:b, Normal(1.0)))
push!(bn_gibbs, LinearGaussianCPD(:c, [:a, :b], [3.0, 1.0], 0.0, 1.0))

evidence = Assignment(:c =&gt; 10.0)
initial_sample = Assignment(:a =&gt; 1, :b =&gt; 1, :c =&gt; 10.0)
gsampler = GibbsSampler(evidence, burn_in=500, thinning=1, initial_sample=initial_sample)
rand(bn_gibbs, gsampler, 5)</code></pre><h2 id="Parameter-Learning"><a class="docs-heading-anchor" href="#Parameter-Learning">Parameter Learning</a><a id="Parameter-Learning-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-Learning" title="Permalink"></a></h2><p>BayesNets.jl supports parameter learning for an entire graph.</p><pre><code class="language-julia hljs">fit(BayesNet, data, (:a=&gt;:b), [StaticCPD{Normal}, LinearGaussianCPD])</code></pre><pre><code class="language-julia hljs">fit(BayesNet, data, (:a=&gt;:b), LinearGaussianCPD)</code></pre><p>Fitting can be done for specific BayesNets types as well:</p><pre><code class="language-julia hljs">data = DataFrame(c=[1,1,1,1,2,2,2,2,3,3,3,3],
b=[1,1,1,2,2,2,2,1,1,2,1,1],
a=[1,1,1,2,1,1,2,1,1,2,1,1])

bn5 = fit(DiscreteBayesNet, data, (:a=&gt;:b, :a=&gt;:c, :b=&gt;:c))</code></pre><p><img src="../plot6.svg" alt/></p><p>Fitting a <code>DiscreteCPD</code>, which is a <code>CategoricalCPD{Categorical}</code>, can be done with a specified number of categories. This prevents cases where your test data does not provide an example for every category.</p><pre><code class="language-julia hljs">cpd = fit(DiscreteCPD, DataFrame(a=[1,2,1,2,2]), :a, ncategories=3);
cpd = fit(DiscreteCPD, data, :b, [:a], parental_ncategories=[3], target_ncategories=3);</code></pre><h2 id="Inference"><a class="docs-heading-anchor" href="#Inference">Inference</a><a id="Inference-1"></a><a class="docs-heading-anchor-permalink" href="#Inference" title="Permalink"></a></h2><p>Inference methods for discrete Bayesian networks can be used via the <code>infer</code> method:</p><pre><code class="language-julia hljs">bn = DiscreteBayesNet()
push!(bn, DiscreteCPD(:a, [0.3,0.7]))
push!(bn, DiscreteCPD(:b, [0.2,0.8]))
push!(bn, DiscreteCPD(:c, [:a, :b], [2,2],
        [Categorical([0.1,0.9]),
         Categorical([0.2,0.8]),
         Categorical([1.0,0.0]),
         Categorical([0.4,0.6]),
        ]))</code></pre><p><img src="../plot7.svg" alt/></p><pre><code class="language-julia hljs">ϕ = infer(bn, :c, evidence=Assignment(:b=&gt;1))</code></pre><div><div style = "float: left;"><span>2×2 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">c</th><th style = "text-align: left;">potential</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.17</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">2</td><td style = "text-align: right;">0.83</td></tr></tbody></table></div><p>Several inference methods are available. Exact inference is the default.</p><table><tr><th style="text-align: right"><code>Inference Method</code></th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>ExactInference</code></td><td style="text-align: right">Performs exact inference using discrete factors and variable elimination</td></tr><tr><td style="text-align: right"><code>LikelihoodWeightingInference</code></td><td style="text-align: right">Approximates p(query \ evidence) with N weighted samples using likelihood weighted sampling</td></tr><tr><td style="text-align: right"><code>LoopyBelief</code></td><td style="text-align: right">The loopy belief propagation algorithm</td></tr><tr><td style="text-align: right"><code>GibbsSamplingNodewise</code></td><td style="text-align: right">Gibbs sampling where each iteration changes one node</td></tr><tr><td style="text-align: right"><code>GibbsSamplingFull</code></td><td style="text-align: right">Gibbs sampling where each iteration changes all nodes</td></tr></table><pre><code class="language-julia hljs">ϕ = infer(GibbsSamplingNodewise(), bn, [:a, :b], evidence=Assignment(:c=&gt;2))</code></pre><p>Inference produces a <code>Factor</code> type. It can be converted to a DataFrame.</p><pre><code class="language-julia hljs">convert(DataFrame, ϕ)</code></pre><h2 id="Structure-Learning"><a class="docs-heading-anchor" href="#Structure-Learning">Structure Learning</a><a id="Structure-Learning-1"></a><a class="docs-heading-anchor-permalink" href="#Structure-Learning" title="Permalink"></a></h2><p>Structure learning can be done as well.</p><pre><code class="language-julia hljs">using Discretizers
using RDatasets
iris = dataset(&quot;datasets&quot;, &quot;iris&quot;)
names(iris)
data = DataFrame(
    SepalLength = iris[!,:SepalLength],
    SepalWidth = iris[!,:SepalWidth],
    PetalLength = iris[!,:PetalLength],
    PetalWidth = iris[!,:PetalWidth],
    Species = encode(CategoricalDiscretizer(iris[!,:Species]), iris[!,:Species]),
)

data[1:3,:] # only display a subset...</code></pre><div><div style = "float: left;"><span>3×5 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">SepalLength</th><th style = "text-align: left;">SepalWidth</th><th style = "text-align: left;">PetalLength</th><th style = "text-align: left;">PetalWidth</th><th style = "text-align: left;">Species</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Int64" style = "text-align: left;">Int64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">5.1</td><td style = "text-align: right;">3.5</td><td style = "text-align: right;">1.4</td><td style = "text-align: right;">0.2</td><td style = "text-align: right;">1</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">4.9</td><td style = "text-align: right;">3.0</td><td style = "text-align: right;">1.4</td><td style = "text-align: right;">0.2</td><td style = "text-align: right;">1</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">4.7</td><td style = "text-align: right;">3.2</td><td style = "text-align: right;">1.3</td><td style = "text-align: right;">0.2</td><td style = "text-align: right;">1</td></tr></tbody></table></div><p>Here we use the K2 structure learning algorithm which runs in polynomial time but requires that we specify a topological node ordering.</p><pre><code class="language-julia hljs">parameters = K2GraphSearch([:Species, :SepalLength, :SepalWidth, :PetalLength, :PetalWidth],
                       ConditionalLinearGaussianCPD,
                       max_n_parents=2)
bn = fit(BayesNet, data, parameters)</code></pre><p><img src="../plot8.svg" alt/></p><p>CPD types can also be specified per-node. Note that complete CPD definitions are required - simply using <code>StaticCPD</code> is insufficient as you need the target distribution type as well, as in <code>StaticCPD{Categorical}</code>.</p><p>Changing the ordering will change the structure.</p><pre><code class="language-julia hljs">CLG = ConditionalLinearGaussianCPD
parameters = K2GraphSearch([:Species, :PetalLength, :PetalWidth, :SepalLength, :SepalWidth],
                        [StaticCPD{Categorical}, CLG, CLG, CLG, CLG],
                        max_n_parents=2)
fit(BayesNet, data, parameters)</code></pre><p>A <code>ScoringFunction</code> allows for extracting a scoring metric for a CPD given data. The negative BIC score is implemented in <code>NegativeBayesianInformationCriterion</code>.</p><p>A <code>GraphSearchStrategy</code> defines a structure learning algorithm. The K2 algorithm is defined through <code>K2GraphSearch</code> and <code>GreedyHillClimbing</code> is implemented for discrete Bayesian networks and the Bayesian score:</p><pre><code class="language-julia hljs">data = DataFrame(c=[1,1,1,1,2,2,2,2,3,3,3,3],
                 b=[1,1,1,2,2,2,2,1,1,2,1,1],
                 a=[1,1,1,2,1,1,2,1,1,2,1,1])
parameters = GreedyHillClimbing(ScoreComponentCache(data), max_n_parents=3, prior=UniformPrior())
bn = fit(DiscreteBayesNet, data, parameters)</code></pre><p><img src="../plot9.svg" alt/></p><p>We can specify the number of categories for each variable in case it cannot be correctly inferred:</p><pre><code class="language-julia hljs">bn = fit(DiscreteBayesNet, data, parameters, ncategories=[3,3,2])</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40.248" height="67.907" viewBox="0 0 40.248 67.907">
<defs>
<g>
<g id="glyph-1741536290880648--0-0">
<path d="M 4.71875 -0.875 L 4.71875 -1.421875 L 4.484375 -1.421875 L 4.484375 -0.875 C 4.484375 -0.296875 4.234375 -0.25 4.125 -0.25 C 3.8125 -0.25 3.765625 -0.6875 3.765625 -0.734375 L 3.765625 -2.6875 C 3.765625 -3.09375 3.765625 -3.484375 3.40625 -3.84375 C 3.03125 -4.21875 2.546875 -4.375 2.078125 -4.375 C 1.265625 -4.375 0.59375 -3.921875 0.59375 -3.28125 C 0.59375 -2.984375 0.796875 -2.8125 1.046875 -2.8125 C 1.328125 -2.8125 1.5 -3.015625 1.5 -3.265625 C 1.5 -3.390625 1.453125 -3.703125 1 -3.71875 C 1.265625 -4.0625 1.734375 -4.171875 2.046875 -4.171875 C 2.53125 -4.171875 3.09375 -3.78125 3.09375 -2.921875 L 3.09375 -2.546875 C 2.59375 -2.53125 1.90625 -2.5 1.296875 -2.203125 C 0.5625 -1.875 0.3125 -1.359375 0.3125 -0.921875 C 0.3125 -0.140625 1.265625 0.109375 1.875 0.109375 C 2.53125 0.109375 2.96875 -0.28125 3.15625 -0.75 C 3.203125 -0.359375 3.46875 0.0625 3.921875 0.0625 C 4.125 0.0625 4.71875 -0.078125 4.71875 -0.875 Z M 3.09375 -1.375 C 3.09375 -0.4375 2.390625 -0.109375 1.953125 -0.109375 C 1.46875 -0.109375 1.0625 -0.453125 1.0625 -0.9375 C 1.0625 -1.484375 1.484375 -2.28125 3.09375 -2.34375 Z M 3.09375 -1.375 "/>
</g>
<g id="glyph-1741536290880648--0-1">
<path d="M 5.09375 -2.109375 C 5.09375 -3.359375 4.140625 -4.328125 3.015625 -4.328125 C 2.265625 -4.328125 1.84375 -3.859375 1.6875 -3.6875 L 1.6875 -6.78125 L 0.28125 -6.6875 L 0.28125 -6.375 C 0.953125 -6.375 1.03125 -6.3125 1.03125 -5.828125 L 1.03125 0 L 1.28125 0 L 1.640625 -0.609375 C 1.78125 -0.375 2.1875 0.109375 2.921875 0.109375 C 4.078125 0.109375 5.09375 -0.84375 5.09375 -2.109375 Z M 4.28125 -2.125 C 4.28125 -1.765625 4.265625 -1.171875 3.984375 -0.734375 C 3.78125 -0.4375 3.40625 -0.109375 2.875 -0.109375 C 2.4375 -0.109375 2.078125 -0.34375 1.84375 -0.703125 C 1.71875 -0.90625 1.71875 -0.9375 1.71875 -1.109375 L 1.71875 -3.125 C 1.71875 -3.3125 1.71875 -3.328125 1.8125 -3.484375 C 2.203125 -4.03125 2.734375 -4.109375 2.96875 -4.109375 C 3.40625 -4.109375 3.765625 -3.859375 4 -3.484375 C 4.25 -3.078125 4.28125 -2.53125 4.28125 -2.125 Z M 4.28125 -2.125 "/>
</g>
<g id="glyph-1741536290880648--0-2">
<path d="M 4.0625 -1.15625 C 4.0625 -1.265625 3.96875 -1.265625 3.9375 -1.265625 C 3.84375 -1.265625 3.828125 -1.21875 3.8125 -1.15625 C 3.515625 -0.25 2.890625 -0.140625 2.53125 -0.140625 C 2 -0.140625 1.140625 -0.5625 1.140625 -2.125 C 1.140625 -3.734375 1.953125 -4.140625 2.46875 -4.140625 C 2.546875 -4.140625 3.171875 -4.125 3.515625 -3.78125 C 3.109375 -3.75 3.046875 -3.453125 3.046875 -3.328125 C 3.046875 -3.078125 3.234375 -2.875 3.5 -2.875 C 3.75 -2.875 3.953125 -3.046875 3.953125 -3.328125 C 3.953125 -4 3.203125 -4.375 2.453125 -4.375 C 1.234375 -4.375 0.328125 -3.328125 0.328125 -2.109375 C 0.328125 -0.859375 1.296875 0.109375 2.4375 0.109375 C 3.75 0.109375 4.0625 -1.0625 4.0625 -1.15625 Z M 4.0625 -1.15625 "/>
</g>
</g>
</defs>
<path fill="none" stroke-width="0.3985" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M -5.806404 -5.80648 L -21.731303 -21.731379 " transform="matrix(0.981659, 0, 0, -0.981659, 33.805375, 6.081269)"/>
<path fill="none" stroke-width="0.31879" stroke-linecap="round" stroke-linejoin="round" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M -1.195796 1.592648 C -1.0945 0.996129 0.0000569349 0.0985357 0.30113 0.0000537038 C 0.0000569349 -0.0984283 -1.0945 -0.996021 -1.195796 -1.592541 " transform="matrix(-0.694131, 0.694131, 0.694131, 0.694131, 12.470705, 27.415939)"/>
<path fill="none" stroke-width="0.3985" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M -0.00070037 -5.80648 L -0.00070037 -50.429621 " transform="matrix(0.981659, 0, 0, -0.981659, 33.805375, 6.081269)"/>
<path fill="none" stroke-width="0.31879" stroke-linecap="round" stroke-linejoin="round" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M -1.197188 1.594973 C -1.097707 0.998088 0.000561385 0.0987805 0.299004 -0.00070037 C 0.000561385 -0.100181 -1.097707 -0.995509 -1.197188 -1.592394 " transform="matrix(0, 0.981659, 0.981659, 0, 33.805375, 55.585386)"/>
<path fill="none" stroke-width="0.3985" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M -22.0576 -34.636038 L -6.057096 -50.636542 " transform="matrix(0.981659, 0, 0, -0.981659, 33.805375, 6.081269)"/>
<path fill="none" stroke-width="0.31879" stroke-linecap="round" stroke-linejoin="round" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M -1.195135 1.592561 C -1.093839 0.996041 0.000717586 0.0984483 0.296164 -0.0000336828 C 0.000717586 -0.0985157 -1.093839 -0.996109 -1.195135 -1.592628 " transform="matrix(0.694131, 0.694131, 0.694131, -0.694131, 27.860853, 55.790494)"/>
<g fill="rgb(0%25, 0%25, 0%25)" fill-opacity="1">
<use xlink:href="%23glyph-1741536290880648--0-0" x="31.360064" y="8.21834"/>
</g>
<g fill="rgb(0%25, 0%25, 0%25)" fill-opacity="1">
<use xlink:href="%23glyph-1741536290880648--0-1" x="3.260088" y="37.247946"/>
</g>
<g fill="rgb(0%25, 0%25, 0%25)" fill-opacity="1">
<use xlink:href="%23glyph-1741536290880648--0-2" x="31.633946" y="63.871507"/>
</g>
</svg>

'/><p>A whole suite of features are supported for DiscreteBayesNets. Here, we illustrate the following:</p><ol><li>Obtain a list of counts for a node</li><li>Obtain sufficient statistics from a discrete dataset</li><li>Obtain the factor table for a node</li><li>Obtain a factor table matching a particular assignment</li></ol><p>We also detail obtaining a Bayesian score for a network structure in the next section.</p><pre><code class="language-julia hljs">count(bn, :a, data)</code></pre><div><div style = "float: left;"><span>2×2 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">a</th><th style = "text-align: left;">count</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">9</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">2</td><td style = "text-align: right;">3</td></tr></tbody></table></div><pre><code class="language-julia hljs">statistics(bn.dag, data)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Matrix{Int64}}:
 [4; 4; 4;;]
 [3 1 3; 1 3 1]
 [3 1 … 2 0; 0 0 … 1 1]</code></pre><pre><code class="language-julia hljs">table(bn, :b)</code></pre><div><div style = "float: left;"><span>6×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">a</th><th style = "text-align: left;">b</th><th style = "text-align: left;">potential</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.666667</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.166667</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">1</td><td style = "text-align: right;">2</td><td style = "text-align: right;">0.25</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">2</td><td style = "text-align: right;">2</td><td style = "text-align: right;">0.666667</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">1</td><td style = "text-align: right;">3</td><td style = "text-align: right;">0.0833333</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">2</td><td style = "text-align: right;">3</td><td style = "text-align: right;">0.166667</td></tr></tbody></table></div><pre><code class="language-julia hljs">table(bn, :c, :a=&gt;1)</code></pre><div><div style = "float: left;"><span>9×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">b</th><th style = "text-align: left;">a</th><th style = "text-align: left;">c</th><th style = "text-align: left;">potential</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.4</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.2</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">3</td><td style = "text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.333333</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">2</td><td style = "text-align: right;">0.2</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: right;">2</td><td style = "text-align: right;">0.6</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">3</td><td style = "text-align: right;">1</td><td style = "text-align: right;">2</td><td style = "text-align: right;">0.333333</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">3</td><td style = "text-align: right;">0.4</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: right;">3</td><td style = "text-align: right;">0.2</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: right;">3</td><td style = "text-align: right;">1</td><td style = "text-align: right;">3</td><td style = "text-align: right;">0.333333</td></tr></tbody></table></div><h2 id="Reading-from-XDSL"><a class="docs-heading-anchor" href="#Reading-from-XDSL">Reading from XDSL</a><a id="Reading-from-XDSL-1"></a><a class="docs-heading-anchor-permalink" href="#Reading-from-XDSL" title="Permalink"></a></h2><p>Discrete Bayesian Networks can be read from the .XDSL file format.</p><pre><code class="language-julia hljs">bn = readxdsl(joinpath(dirname(pathof(BayesNets)), &quot;..&quot;, &quot;test&quot;, &quot;sample_bn.xdsl&quot;))</code></pre><p><img src="../plot10.svg" alt/></p><h2 id="Bayesian-Score-for-a-Network-Structure"><a class="docs-heading-anchor" href="#Bayesian-Score-for-a-Network-Structure">Bayesian Score for a Network Structure</a><a id="Bayesian-Score-for-a-Network-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian-Score-for-a-Network-Structure" title="Permalink"></a></h2><p>The Bayesian score for a discrete-valued BayesNet can be calculated based only on the structure and data (the CPDs do not need to be defined beforehand). This is implemented with a method of <code>bayesian_score</code> that takes in a directed graph, the names of the nodes and data.</p><pre><code class="language-julia hljs">data = DataFrame(c=[1,1,1,1,2,2,2,2,3,3,3,3],
                 b=[1,1,1,2,2,2,2,1,1,2,1,1],
                 a=[1,1,1,2,1,1,2,1,1,2,1,1])
g = DAG(3)
add_edge!(g,1,2); add_edge!(g,2,3); add_edge!(g,1,3)
bayesian_score(g, [:a,:b,:c], data)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-29.642240688899513</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../install/">« Installation</a><a class="docs-footer-nextpage" href="../concepts/">Concepts »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Sunday 9 March 2025 16:06">Sunday 9 March 2025</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
